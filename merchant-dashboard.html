<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes, viewport-fit=cover">
    <meta name="description" content="Merchant Dashboard - Maasai Marketplace">
    <meta name="theme-color" content="#d4a574">
    <title>Merchant Dashboard - Maasai Marketplace</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        .marketplace-nav {
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-bottom: 2px solid rgba(212, 165, 116, 0.2);
        }

        .marketplace-nav .nav-brand h1 {
            background: linear-gradient(135deg, var(--secondary-color) 0%, var(--primary-color) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .marketplace-nav .nav-brand .tagline {
            color: var(--text-light);
            font-size: 0.75rem;
        }

        .marketplace-nav .cart-icon-link {
            text-decoration: none;
            font-size: 1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.625rem 1rem;
            border-radius: 8px;
            background: rgba(212, 165, 116, 0.1);
            color: var(--primary-color);
            transition: all 0.3s ease;
            white-space: nowrap;
            position: relative;
        }

        .marketplace-nav .cart-icon-link:hover {
            background: rgba(212, 165, 116, 0.2);
            transform: translateY(-2px);
        }

        .marketplace-nav .cart-badge {
            position: absolute;
            top: -6px;
            right: -6px;
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            min-width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: 700;
            border: 2px solid white;
            padding: 0 4px;
            box-sizing: border-box;
            white-space: nowrap;
        }

        .merchant-dashboard {
            min-height: calc(100vh - 200px);
            background: linear-gradient(135deg, rgba(212, 165, 116, 0.05) 0%, rgba(44, 85, 48, 0.02) 100%);
            padding: 2rem 1rem;
            margin-top: 80px;
        }

        .merchant-header {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            border: 2px solid rgba(212, 165, 116, 0.2);
        }

        .merchant-header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .merchant-header h1 {
            font-size: 2rem;
            color: var(--secondary-color);
            margin-bottom: 0.5rem;
        }

        .merchant-header p {
            color: var(--text-light);
        }

        .btn-logout {
            padding: 0.75rem 1.5rem;
            background: transparent;
            color: var(--text-dark);
            border: 2px solid rgba(212, 165, 116, 0.3);
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-logout:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        .merchant-container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .merchant-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            background: white;
            padding: 0.5rem;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            border: 2px solid rgba(212, 165, 116, 0.2);
            flex-wrap: wrap;
        }

        .merchant-tab {
            flex: 1;
            padding: 1rem 1.5rem;
            background: transparent;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            color: var(--text-dark);
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 150px;
            text-align: center;
        }

        .merchant-tab.active {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
            color: white;
        }

        .merchant-tab-content {
            display: none;
        }

        .merchant-tab-content.active {
            display: block;
        }

        .product-form-card {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            border: 2px solid rgba(212, 165, 116, 0.2);
            margin-bottom: 2rem;
        }

        .product-form-card h2 {
            font-size: 1.75rem;
            color: var(--secondary-color);
            margin-bottom: 1.5rem;
        }

        .product-form {
            display: grid;
            gap: 1.5rem;
        }

        .form-row-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .form-group label {
            font-weight: 600;
            color: var(--secondary-color);
            font-size: 0.9rem;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 0.875rem 1rem;
            border: 2px solid rgba(212, 165, 116, 0.3);
            border-radius: 8px;
            font-size: 0.95rem;
            font-family: inherit;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(212, 165, 116, 0.15);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .image-upload-area {
            border: 2px dashed rgba(212, 165, 116, 0.3);
            border-radius: 8px;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(212, 165, 116, 0.05);
        }

        .image-upload-area:hover {
            border-color: var(--primary-color);
            background: rgba(212, 165, 116, 0.1);
        }

        .image-upload-area.has-image {
            border-style: solid;
            border-color: var(--primary-color);
        }

        .image-preview {
            max-width: 200px;
            max-height: 200px;
            border-radius: 8px;
            margin: 1rem auto;
            display: none;
        }

        .image-preview.show {
            display: block;
        }

        .btn-submit-product {
            padding: 1rem 2rem;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 16px rgba(212, 165, 116, 0.3);
        }

        .btn-submit-product:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 24px rgba(212, 165, 116, 0.4);
        }

        .products-list-card {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            border: 2px solid rgba(212, 165, 116, 0.2);
        }

        .products-list-card h2 {
            font-size: 1.75rem;
            color: var(--secondary-color);
            margin-bottom: 1.5rem;
        }

        .products-table {
            width: 100%;
            border-collapse: collapse;
        }

        .products-table th {
            text-align: left;
            padding: 1rem;
            background: rgba(212, 165, 116, 0.1);
            color: var(--secondary-color);
            font-weight: 700;
            border-bottom: 2px solid rgba(212, 165, 116, 0.2);
        }

        .products-table td {
            padding: 1rem;
            border-bottom: 1px solid rgba(212, 165, 116, 0.1);
        }

        .products-table tr:hover {
            background: rgba(212, 165, 116, 0.05);
        }

        .product-image-small {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 8px;
        }

        .btn-edit,
        .btn-delete {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-right: 0.5rem;
        }

        .btn-edit {
            background: rgba(212, 165, 116, 0.2);
            color: var(--primary-color);
        }

        .btn-edit:hover {
            background: var(--primary-color);
            color: white;
        }

        .btn-delete {
            background: rgba(220, 53, 69, 0.1);
            color: #dc3545;
        }

        .btn-delete:hover {
            background: #dc3545;
            color: white;
        }

        .success-message {
            background: rgba(40, 167, 69, 0.1);
            color: #28a745;
            padding: 1rem;
            border-radius: 8px;
            border-left: 4px solid #28a745;
            margin-bottom: 1.5rem;
            display: none;
        }

        .success-message.show {
            display: block;
        }

        @media (max-width: 768px) {
            .merchant-header-content {
                flex-direction: column;
                align-items: flex-start;
            }

            .merchant-tabs {
                flex-direction: column;
            }

            .merchant-tab {
                width: 100%;
            }

            .form-row-2 {
                grid-template-columns: 1fr;
            }

            .products-table {
                font-size: 0.875rem;
            }

            .products-table th,
            .products-table td {
                padding: 0.75rem 0.5rem;
            }

            .product-image-small {
                width: 50px;
                height: 50px;
            }
        }

        @media (max-width: 480px) {
            .merchant-dashboard {
                padding: 1rem 0.5rem;
            }

            .product-form-card,
            .products-list-card {
                padding: 1.5rem;
            }

            .products-table {
                display: block;
                overflow-x: auto;
            }
        }

        @media (max-width: 768px) {
            .marketplace-nav .nav-menu {
                position: fixed;
                top: 70px;
                left: 0;
                right: 0;
                background: white;
                flex-direction: column;
                padding: 1rem;
                box-shadow: 0 4px 6px rgba(0,0,0,0.1);
                display: none;
                z-index: 999;
                border-top: 2px solid rgba(212, 165, 116, 0.2);
            }

            .marketplace-nav .nav-menu.active {
                display: flex;
            }

            .marketplace-nav .nav-menu li {
                width: 100%;
            }

            .marketplace-nav .nav-menu a {
                display: block;
                padding: 0.75rem 0;
                border-bottom: 1px solid rgba(212, 165, 116, 0.1);
                width: 100%;
            }

            .marketplace-nav .mobile-menu-toggle {
                display: flex;
                flex-direction: column;
                gap: 4px;
                background: transparent;
                border: none;
                cursor: pointer;
                padding: 0.5rem;
            }

            .marketplace-nav .mobile-menu-toggle span {
                width: 25px;
                height: 3px;
                background: var(--secondary-color);
                border-radius: 2px;
                transition: all 0.3s ease;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar marketplace-nav">
        <div class="container">
            <div class="nav-brand">
                <h1>Maasai Marketplace</h1>
                <span class="tagline">Authentic Handmade Products</span>
            </div>
            <ul class="nav-menu">
                <li><a href="index.html">Home</a></li>
                <li><a href="marketplace.html">Shop</a></li>
                <li><a href="marketplace.html#jewelry">Jewelry</a></li>
                <li><a href="marketplace.html#bags">Bags</a></li>
                <li><a href="marketplace.html#clothing">Clothing</a></li>
                <li><a href="marketplace.html#home">Home Decor</a></li>
                <li><a href="marketplace.html#art">Art</a></li>
                <li>
                    <a href="cart.html" class="cart-icon-link" style="position: relative;">
                        ðŸ›’ Cart
                        <span id="cartBadge" class="cart-badge" style="display: none;">0</span>
                    </a>
                </li>
            </ul>
            <button class="mobile-menu-toggle" aria-label="Toggle menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </nav>

    <div class="merchant-dashboard">
        <div class="merchant-container">
            <div class="merchant-header">
                <div class="merchant-header-content">
                    <div>
                        <h1>Merchant Dashboard</h1>
                        <p>Manage your products on Maasai Marketplace</p>
                    </div>
                    <button class="btn-logout" onclick="handleLogout()">Logout</button>
                </div>
            </div>

            <div class="merchant-tabs">
                <button class="merchant-tab active" onclick="switchTab('add')">Add Product</button>
                <button class="merchant-tab" onclick="switchTab('manage')">Manage Products</button>
            </div>

            <div id="addProductTab" class="merchant-tab-content active">
                <div class="product-form-card">
                    <h2>Add New Product</h2>
                    <div class="success-message" id="successMessage">
                        âœ“ Product added successfully!
                    </div>
                    <form class="product-form" id="addProductForm" onsubmit="handleAddProduct(event)">
                        <div class="form-group">
                            <label for="productName">Product Name *</label>
                            <input type="text" id="productName" name="productName" required>
                        </div>

                        <div class="form-row-2">
                            <div class="form-group">
                                <label for="productCategory">Category *</label>
                                <select id="productCategory" name="productCategory" required>
                                    <option value="">Select Category</option>
                                    <option value="jewelry">Jewelry</option>
                                    <option value="bags">Bags</option>
                                    <option value="clothing">Clothing</option>
                                    <option value="home">Home Decor</option>
                                    <option value="art">Art & Collectibles</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="productPrice">Price (KES) *</label>
                                <input type="number" id="productPrice" name="productPrice" min="0" step="100" required>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="productDescription">Description *</label>
                            <textarea id="productDescription" name="productDescription" required></textarea>
                        </div>

                        <div class="form-group">
                            <label for="productImage">Product Image *</label>
                            <div class="image-upload-area" onclick="document.getElementById('productImageInput').click()">
                                <input type="file" id="productImageInput" accept="image/*" style="display: none;" onchange="handleImageUpload(event)" required>
                                <div id="imageUploadText">
                                    <p>ðŸ“· Click to upload image</p>
                                    <p style="font-size: 0.875rem; color: var(--text-light); margin-top: 0.5rem;">or drag and drop</p>
                                </div>
                                <img id="imagePreview" class="image-preview" alt="Preview">
                            </div>
                        </div>

                        <button type="submit" class="btn-submit-product">Add Product</button>
                    </form>
                </div>
            </div>

            <div id="manageProductsTab" class="merchant-tab-content">
                <div class="products-list-card">
                    <h2>Your Products</h2>
                    <div id="productsList">
                        <!-- Products will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer marketplace-footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Maasai Marketplace</h3>
                    <p>Authentic Handmade Products</p>
                    <p>Supporting Il Ngwesi Community</p>
                </div>
                <div class="footer-section">
                    <h4>Shop</h4>
                    <p><a href="marketplace.html" style="color: var(--text-light); text-decoration: none;">All Products</a></p>
                    <p><a href="marketplace.html#jewelry" style="color: var(--text-light); text-decoration: none;">Jewelry</a></p>
                    <p><a href="marketplace.html#clothing" style="color: var(--text-light); text-decoration: none;">Clothing</a></p>
                    <p><a href="marketplace.html#home" style="color: var(--text-light); text-decoration: none;">Home Decor</a></p>
                </div>
                <div class="footer-section">
                    <h4>Customer Service</h4>
                    <p>Email: marketplace@ilngwesi.com</p>
                    <p>Phone: +254 (0) 741 770 540</p>
                    <p>Delivery: Within Kenya Only</p>
                </div>
                <div class="footer-section">
                    <h4>About</h4>
                    <p><a href="index.html" style="color: var(--text-light); text-decoration: none;">Il Ngwesi Conservancy</a></p>
                    <p>Community-owned marketplace</p>
                    <p>Every purchase supports conservation</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; <span id="copyrightYear"></span> Maasai Marketplace - Il Ngwesi Conservancy. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        // Check authentication
        if (sessionStorage.getItem('merchantLoggedIn') !== 'true') {
            window.location.href = 'merchant-login.html';
        }

        function handleLogout() {
            sessionStorage.removeItem('merchantLoggedIn');
            sessionStorage.removeItem('merchantName');
            window.location.href = 'merchant-login.html';
        }

        function switchTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.merchant-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');

            // Update tab content
            document.querySelectorAll('.merchant-tab-content').forEach(content => {
                content.classList.remove('active');
            });

            if (tabName === 'add') {
                document.getElementById('addProductTab').classList.add('active');
            } else {
                document.getElementById('manageProductsTab').classList.add('active');
                loadProducts();
            }
        }

        function handleImageUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.getElementById('imagePreview');
                    const uploadArea = document.querySelector('.image-upload-area');
                    const uploadText = document.getElementById('imageUploadText');
                    
                    preview.src = e.target.result;
                    preview.classList.add('show');
                    uploadArea.classList.add('has-image');
                    uploadText.style.display = 'none';
                };
                reader.readAsDataURL(file);
            }
        }

        function handleAddProduct(event) {
            event.preventDefault();

            const formData = {
                name: document.getElementById('productName').value,
                category: document.getElementById('productCategory').value,
                price: parseFloat(document.getElementById('productPrice').value),
                description: document.getElementById('productDescription').value,
                image: document.getElementById('imagePreview').src || ''
            };

            // Get existing products from localStorage
            const existingProducts = JSON.parse(localStorage.getItem('marketplaceProducts') || '[]');
            
            // Generate new ID
            const newId = existingProducts.length > 0 
                ? Math.max(...existingProducts.map(p => p.id)) + 1 
                : 1;

            // Add new product
            const newProduct = {
                id: newId,
                ...formData,
                image: formData.image || 'data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 200 200%27%3E%3Crect fill=%27%23f3f4f6%27 width=%27200%27 height=%27200%27/%3E%3Ctext fill=%27%239ca3af%27 font-family=%27sans-serif%27 font-size=%2714%27 x=%2750%25%27 y=%2750%25%27 text-anchor=%27middle%27 dy=%27.3em%27%3ENo Image%3C/text%3E%3C/svg%3E'
            };

            existingProducts.push(newProduct);
            localStorage.setItem('marketplaceProducts', JSON.stringify(existingProducts));

            // Show success message
            const successMsg = document.getElementById('successMessage');
            successMsg.classList.add('show');
            setTimeout(() => {
                successMsg.classList.remove('show');
            }, 3000);

            // Reset form
            document.getElementById('addProductForm').reset();
            document.getElementById('imagePreview').classList.remove('show');
            document.getElementById('imagePreview').src = '';
            document.querySelector('.image-upload-area').classList.remove('has-image');
            document.getElementById('imageUploadText').style.display = 'block';
        }

        function loadProducts() {
            const products = JSON.parse(localStorage.getItem('marketplaceProducts') || '[]');
            const productsList = document.getElementById('productsList');

            if (products.length === 0) {
                productsList.innerHTML = '<p style="text-align: center; color: var(--text-light); padding: 2rem;">No products yet. Add your first product!</p>';
                return;
            }

            // Create table
            let tableHTML = `
                <div style="overflow-x: auto;">
                    <table class="products-table">
                        <thead>
                            <tr>
                                <th>Image</th>
                                <th>Name</th>
                                <th>Category</th>
                                <th>Price</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
            `;

            products.forEach(product => {
                tableHTML += `
                    <tr>
                        <td>
                            <img src="${product.image}" alt="${product.name}" class="product-image-small" onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 200 200%27%3E%3Crect fill=%27%23f3f4f6%27 width=%27200%27 height=%27200%27/%3E%3Ctext fill=%27%239ca3af%27 font-family=%27sans-serif%27 font-size=%2714%27 x=%2750%25%27 y=%2750%25%27 text-anchor=%27middle%27 dy=%27.3em%27%3ENo Image%3C/text%3E%3C/svg%3E'">
                        </td>
                        <td><strong>${product.name}</strong></td>
                        <td><span style="text-transform: capitalize;">${product.category}</span></td>
                        <td>KES ${product.price.toLocaleString()}</td>
                        <td>
                            <button class="btn-edit" onclick="editProduct(${product.id})">Edit</button>
                            <button class="btn-delete" onclick="deleteProduct(${product.id})">Delete</button>
                        </td>
                    </tr>
                `;
            });

            tableHTML += `
                        </tbody>
                    </table>
                </div>
            `;

            productsList.innerHTML = tableHTML;
        }

        function deleteProduct(productId) {
            if (confirm('Are you sure you want to delete this product?')) {
                const products = JSON.parse(localStorage.getItem('marketplaceProducts') || '[]');
                const filtered = products.filter(p => p.id !== productId);
                localStorage.setItem('marketplaceProducts', JSON.stringify(filtered));
                loadProducts();
            }
        }

        function editProduct(productId) {
            // For now, just show an alert. Can be enhanced later
            alert('Edit functionality coming soon! For now, please delete and re-add the product.');
        }

        // Load products on page load if on manage tab
        if (document.getElementById('manageProductsTab').classList.contains('active')) {
            loadProducts();
        }

        // Initialize mobile menu toggle
        const mobileToggle = document.querySelector('.mobile-menu-toggle');
        const navMenu = document.querySelector('.nav-menu');
        
        if (mobileToggle && navMenu) {
            mobileToggle.addEventListener('click', function(e) {
                e.stopPropagation();
                navMenu.classList.toggle('active');
                
                const spans = mobileToggle.querySelectorAll('span');
                if (navMenu.classList.contains('active')) {
                    spans[0].style.transform = 'rotate(45deg) translate(5px, 5px)';
                    spans[1].style.opacity = '0';
                    spans[2].style.transform = 'rotate(-45deg) translate(7px, -6px)';
                    document.body.style.overflow = 'hidden';
                } else {
                    spans[0].style.transform = 'none';
                    spans[1].style.opacity = '1';
                    spans[2].style.transform = 'none';
                    document.body.style.overflow = '';
                }
            });
            
            document.addEventListener('click', function(e) {
                if (!navMenu.contains(e.target) && !mobileToggle.contains(e.target) && navMenu.classList.contains('active')) {
                    navMenu.classList.remove('active');
                    const spans = mobileToggle.querySelectorAll('span');
                    spans[0].style.transform = 'none';
                    spans[1].style.opacity = '1';
                    spans[2].style.transform = 'none';
                    document.body.style.overflow = '';
                }
            });
        }
    </script>
    <script src="cart.js"></script>
    <script src="script.js"></script>
    <script>
        // Set copyright year dynamically
        document.getElementById('copyrightYear').textContent = new Date().getFullYear();
    </script>
</body>
</html>
